<!--pages/charm/pages/publishTaskForm/publishTaskForm.wxml-->
<text>pages/charm/pages/publishTaskForm/publishTaskForm.wxml</text>
<cu-custom bgColor="bg-gradual-blue" isBack="{{true}}">
  <view slot="content">任务发布</view>
</cu-custom>
<view class="padding-lr-lg">

  <view class="cu-form-group">
    <view class="title"><text class="text-red">* </text>任务名称：</view>
    <input placeholder="请输入任务名称" bindinput="putData" data-key="taskName"></input>
  </view>
  <view class="cu-form-group">
    <view class="title">部门选择</view>
    <button class="cu-btn bg-green shadow round" bindtap="showModal" data-target="RadioModal">请选择</button>
  </view>

  <view class="cu-form-group" wx:if="{{selectDepts.length>0}}">
   <view class="text-grey"> {{selectDepts}}</view>
  </view>

  <view class="cu-modal  margin-top-lg {{modalName=='RadioModal'?'show':''}}">
  
    <scroll-view scroll-y='true' class="cu-dialog" catchtap style=" height: 80%;">
      <checkbox-group class="block" bindchange="deptSelect">
        <view class="cu-list menu text-left">
          <view class="cu-item" wx:for="{{deptList}}" wx:key="item" catchtap="deptNameSelect"
            data-id="{{item.taskPersonId}}">
            <label class="flex justify-between align-center flex-sub">
              <view class="flex-sub">{{item.orgjob}}——{{item.tname}}</view>
              <checkbox class="round" value="{{item.tname}}"></checkbox>
            </label>
          </view>
        </view>
      </checkbox-group>
      <view class="selectBtn" style="">
        <button class="cu-btn bg-green lg" bindtap="hideModal">取消</button>
        <button class="cu-btn bg-green margin-left-lg lg" bindtap="determine">确定</button>
      </view>
    </scroll-view>

  </view>

  <view class="cu-form-group" style="border-top: 1rpx solid #eee;">
    <view class="title">任务发起时间</view>
    <picker mode="date" value="{{date}}" start="{{startDate}}" end="2220-01-01" bindchange="startDateChange">
      <view class="picker">
        {{startDate}}
      </view>
    </picker>
  </view>

  <view class="cu-form-group">
    <view class="title">截止时间</view>
    <picker mode="date" value="{{date}}" start="{{startDate}}" end="2220-01-01" bindchange="endDateChange">
      <view class="picker">
        {{endDate}}
      </view>
    </picker>
  </view>

  <view class="cu-form-group align-start">
    <view class="title"><text class="text-red">* </text>任务内容：</view>
    <textarea maxlength="-1" placeholder="请输入任务内容" bindinput="putData" data-key="taskInfo"></textarea>
  </view>

	<view class="cu-form-group padding-left-sm align-start padding-top-sm">
		<view class="title padding-top-sm" style="margin:0">录音：</view>
		<view bindtap="showVoice"  class="cuIcon-rankfill bg-green radius margin-right padding-left" style="height:60rpx;flex:1;line-height:60rpx">  {{voiceLong}}{{voiceStatus}}</view>
		<view bindlongpress="startrecord" bindtouchend="endrecord" class="flex align-center" style="margin-left:auto " >
			<text class="cuIcon-voice round bg-green text-center" style="width:60rpx;height:60rpx;line-height:60rpx"></text>
			<text class="text-xs margin-left-xs">按住\n录制</text>
		</view>
	</view>


  <!-- 图片上传 -->
  <view class="cu-form-group padding-left align-start ">
		<view class="title padding-top-lg" >任务图片：</view>
		<view class="grid col-3 grid-square flex-sub padding-top-sm">
			<view class="bg-img" wx:for="{{vehicleImages}}" wx:key="{{index}}" bindtap="ViewVideo" data-type="image"
				data-url="{{vehicleImages[index]}}">
				<image src='{{vehicleImages[index]}}' mode='aspectFill'></image>
				<view class="cu-tag bg-red" catchtap="DelImg" data-index="{{index}}" data-type="image">
					<text class="cuIcon-close"></text>
				</view>
			</view>
			<view class="solids" bindtap="ChooseImage" wx:if="{{vehicleImages.length<3}}">
				<text class="cuIcon-cameraadd"></text>
			</view>
		</view>
	</view>

  <!-- 提交 -->
  <view class="padding flex flex-direction">
    <button bindtap="commitData" class="cu-btn bg-green margin-tb-sm lg">发布任务</button>  
  </view>


</view>